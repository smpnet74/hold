<joblist>
  <job>
    <defaultTab>nodes</defaultTab>
    <description></description>
    <dispatch>
      <excludePrecedence>true</excludePrecedence>
      <keepgoing>false</keepgoing>
      <rankOrder>ascending</rankOrder>
      <successOnEmptyNodeFilter>false</successOnEmptyNodeFilter>
      <threadcount>1</threadcount>
    </dispatch>
    <executionEnabled>true</executionEnabled>
    <id>6f5c8abe-8d2c-4462-94d5-f3b052b01424</id>
    <loglevel>INFO</loglevel>
    <name>singlejob - create spotcluster1 yaml</name>
    <nodeFilterEditable>false</nodeFilterEditable>
    <nodefilters>
      <filter>.*</filter>
    </nodefilters>
    <nodesSelectedByDefault>true</nodesSelectedByDefault>
    <scheduleEnabled>true</scheduleEnabled>
    <sequence keepgoing='false' strategy='node-first'>
      <command>
        <script><![CDATA[#!/bin/bash

FILE=~/spotcluster1.yaml
if [ -f "$FILE" ]; then
    echo "$FILE exist"
else 
cat << EOF > ~/spotcluster1.yaml
# An example of ClusterConfig showing nodegroups with mixed instances (spot and on demand):
---
apiVersion: eksctl.io/v1alpha5
kind: ClusterConfig

metadata:
    name: spotcluster1
    region: us-east-1

vpc:
  id: "vpc-08b08d0ec21003091"
  cidr: "10.0.0.0/16"
  subnets:
    public:
      us-east-1c:
        id: "subnet-02be4322c2cf0d69a"
        cidr: "10.0.2.0/24"
      us-east-1a:
        id: "subnet-0d48214468a46af5d"
        cidr: "10.0.1.0/24"

nodeGroups:
    - name: ng-1
      minSize: 2
      maxSize: 6
      instancesDistribution:
        maxPrice: 0.06
        instanceTypes: ["t3.medium"]  # At least two instance types should be specified
        onDemandBaseCapacity: 0
        onDemandPercentageAboveBaseCapacity: 50
        spotInstancePools: 2
      iam:
        withAddonPolicies:
          autoScaler: true
          albIngress: true
EOF
fi]]></script>
        <scriptargs />
      </command>
    </sequence>
    <uuid>6f5c8abe-8d2c-4462-94d5-f3b052b01424</uuid>
  </job>
</joblist>
